<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X Clone</title>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #e7e9ea;
            display: flex;
            justify-content: center;
        }
        nav {
            width: 250px;
            min-height: 100vh;
            border-right: 1px solid #2f3336;
            padding-top: 20px;
            position: fixed;
            left: 0;
        }
        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        nav li {
            margin-bottom: 20px;
        }
        nav a {
            text-decoration: none;
            color: #e7e9ea;
            font-size: 20px;
            display: flex;
            align-items: center;
            padding: 10px 20px;
        }
        nav a i {
            font-size: 24px;
            margin-right: 15px;
        }
        .main-content {
            width: 600px;
            border-left: 1px solid #2f3336;
            border-right: 1px solid #2f3336;
            min-height: 100vh;
            margin-left: 250px;
            margin-right: 350px;
            display: flex;
            flex-direction: column;
        }
        .header {
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid #2f3336;
        }
        .tab {
            flex: 1;
            text-align: center;
            padding: 15px 0;
            cursor: pointer;
            font-weight: bold;
        }
        .tab.active {
            border-bottom: 4px solid #1d9bf0;
            color: #1d9bf0;
        }
        .content-section {
            display: none;
            flex: 1;
            padding: 15px;
        }
        .content-section.active {
            display: block;
        }
        .tweet-input {
            padding: 15px;
            border-bottom: 1px solid #2f3336;
            display: flex;
        }
        .tweet-input img {
            border-radius: 50%;
            margin-right: 10px;
        }
        .tweet-input textarea {
            flex: 1;
            background-color: #000;
            color: #e7e9ea;
            border: none;
            resize: none;
            font-size: 18px;
            outline: none;
        }
        .tweet-input button {
            background-color: #1d9bf0;
            color: #fff;
            border: none;
            padding: 10px 20px;
            margin-left: 10px;
            border-radius: 20px;
            cursor: pointer;
        }
        aside {
            width: 350px;
            min-height: 100vh;
            padding: 15px;
            position: fixed;
            right: 0;
            top: 0;
        }
        .search-bar {
            display: flex;
            align-items: center;
            background-color: #202327;
            padding: 10px;
            border-radius: 20px;
            margin-bottom: 20px;
        }
        .search-bar input {
            background-color: transparent;
            border: none;
            color: #e7e9ea;
            margin-left: 10px;
            outline: none;
            flex: 1;
        }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <nav>
        <ul>
            <li>
                <a href="#">
                    <i class="fab fa-x-twitter"></i>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fas fa-home"></i> Home
                </a>
            </li>
            <li>
                
                <a href="explore.html">
                    <span class="icon"><i class="fas fa-hashtag"></i></span>
                    <span class="text">Explore</span>
                </a>
            </li>

            <li>
                <a href="#">
                    <i class="fas fa-bell"></i> Notifications
                </a>
            </li>
            <li>
                <a href="messages.html">
                    <i class="fas fa-envelope"></i> Messages
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fas fa-bookmark"></i> Bookmarks
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fas fa-list"></i> Lists
                </a>
            </li>
            <li>
                <a href="login.html">
                    <i class="fas fa-user"></i> Profile
                </a>
            </li>
            <li>
                <a href="settings.html">
                    <i class="fas fa-ellipsis-h"></i> Settings
                </a>
            </li>
        </ul>
    </nav>
    

    <!-- Main Content -->
    <div class="main-content">

        <!-- Header with Tabs -->
        <div class="header">
            <div id="forYouTab" class="tab active" onclick="switchTab('forYou')">For You</div>
            <div id="followingTab" class="tab" onclick="switchTab('following')">Following</div>
        </div>
         <!-- Tweet Input Box -->
         <div style="padding: 15px; border-bottom: 1px solid #2f3336; display: flex;">
            <img src="https://via.placeholder.com/50" alt="User Avatar" style="border-radius: 50%; margin-right: 10px;">
            <textarea id="tweetInput" placeholder="What's happening?" maxlength="280" style="flex: 1; background-color: #000; color: #e7e9ea; border: none; resize: none; font-size: 18px; outline: none;"></textarea>
            <button onclick="postTweet()" style="background-color: #1d9bf0; color: #fff; border: none; padding: 10px 20px; margin-left: 10px; border-radius: 20px; cursor: pointer;">Post</button>
        </div>

        <!-- Tweets Feed -->
        <div id="tweetsFeed" style="flex: 1; padding: 15px;">
            <!-- Tweets will be dynamically added here -->
        </div>

        <!-- Content Sections -->
        <div id="forYouContent" class="content-section active">
            <!-- "For You" content goes here -->
            <p>This is the "For You" feed.</p>
        </div>
        <div id="followingContent" class="content-section">
            <!-- "Following" content goes here -->
            <p>This is the "Following" feed.</p>
        </div>
        

        <!-- Trending Topics -->
        <section class="section-box">
            <h2>Trending Topics</h2>
            <ul>
                <li><a href="#" class="button">#Trend1</a></li>
                <li><a href="#" class="button">#Trend2</a></li>
            </ul>
        </section>
       

         <!-- Right-Side Panel -->
    <aside style="width: 350px; min-height: 100vh; padding: 15px; position: fixed; right: 0; border-left: 1px solid #2f3336;">
        <!-- Search Bar -->
        <div style="background-color: #202327; padding: 10px; border-radius: 20px; display: flex; align-items: center; margin-bottom: 20px;">
            <i class="fas fa-search" style="color: #6e767d; margin-right: 10px;"></i>
            <input type="text" id="searchInput" oninput="searchTweets()" placeholder="Search X" style="background-color: transparent; border: none; color: #e7e9ea; outline: none; flex: 1;">
        </div>

        <!-- Search Results -->
        <div id="searchResults" style="display: none;">
            <!-- Search results will be displayed here -->
        </div>
    </aside>
            
    
    </body>
    <script>
        function switchTab(tab) {
            const forYouTab = document.getElementById('forYouTab');
            const followingTab = document.getElementById('followingTab');
            const forYouContent = document.getElementById('forYouContent');
            const followingContent = document.getElementById('followingContent');
    
            if (tab === 'forYou') {
                forYouTab.classList.add('active');
                followingTab.classList.remove('active');
                forYouContent.classList.add('active');
                followingContent.classList.remove('active');
            } else if (tab === 'following') {
                followingTab.classList.add('active');
                forYouTab.classList.remove('active');
                followingContent.classList.add('active');
                forYouContent.classList.remove('active');
            }
        }
    
    document.addEventListener("DOMContentLoaded", function() {
        fetchTrendingTopics();
        fetchTweets();
    });

    // Fetch Trending Topics
    function fetchTrendingTopics() {
        fetch("/api/trending")
            .then(response => response.json())
            .then(data => {
                let trendingList = document.getElementById("trendingList");
                trendingList.innerHTML = ""; // Clear existing content
                data.forEach(topic => {
                    trendingList.innerHTML += `<li style="padding: 10px 0; border-bottom: 1px solid #333;">
                        <a href="#" style="text-decoration: none; color: #1da1f2; font-weight: bold;">${topic.hashtag}</a>
                        <p style="margin: 5px 0 0; color: #8899a6;">${topic.tweets}</p>
                    </li>`;
                });
            });
    }

    // Fetch Tweets
    function fetchTweets() {
        fetch("/api/tweets")
            .then(response => response.json())
            .then(data => {
                let tweetsFeed = document.getElementById("tweetsFeed");
                tweetsFeed.innerHTML = "";
                data.forEach(tweet => {
                    tweetsFeed.innerHTML += `<div style="background-color: #1a1a1a; padding: 15px; margin-bottom: 10px; border: 1px solid #333; border-radius: 5px;">
                        <p style="margin: 0; color: #ffffff;">${tweet.content}</p>
                        <p style="margin: 5px 0 0; color: #8899a6; font-size: 14px;">${tweet.username} · ${tweet.time}</p>
                    </div>`;
                });
            });
    }

    // Post a Tweet
    function postTweet() {
        let tweetInput = document.getElementById("tweetInput").value;
        if (!tweetInput.trim()) return;

        fetch("/api/tweet", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ content: tweetInput })
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("tweetInput").value = "";
            fetchTweets();
        });
    }
    function fetchUserProfile(username) {
            fetch(`/api/profile/${username}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert("User not found!");
                        return;
                    }
                    document.getElementById("profileName").innerText = data.name;
                    document.getElementById("profileUsername").innerText = data.username;
                    document.getElementById("profileBio").innerText = data.bio;

                    fetchUserTweets(username);
                });
        }

        function fetchUserTweets(username) {
            fetch(`/api/profile/${username}/tweets`)
                .then(response => response.json())
                .then(data => {
                    let tweetsList = document.getElementById("profileTweets");
                    tweetsList.innerHTML = "";
                    data.forEach(tweet => {
                        tweetsList.innerHTML += `<li>${tweet}</li>`;
                    });
                });
        }

        function updateProfile() {
            let username = "user1";  // Hardcoded for now
            let newName = document.getElementById("newName").value;
            let newBio = document.getElementById("newBio").value;

            fetch(`/api/profile/${username}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ name: newName, bio: newBio })
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
                fetchUserProfile(username);
            });
        }
        document.addEventListener("DOMContentLoaded", function() {
    fetchUserProfile();
});

function fetchUserProfile() {
    fetch("/api/profile")
        .then(response => response.json())
        .then(data => {
            if (data.logged_in) {
                document.getElementById("sidebarUsername").innerText = data.username;
                document.getElementById("sidebarHandle").innerText = "@" + data.username;
                document.getElementById("profileAvatar").src = data.avatar;
                document.getElementById("homeAvatar").src = data.avatar;
            } else {
                window.location.href = 'login.html';
            }
        });
}


    </script>
    
